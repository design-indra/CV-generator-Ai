<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV Generator AI</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1a2e;
    --paper: #f5f0e8;
    --gold: #c9a84c;
    --gold-light: #e8d5a3;
    --cream: #faf7f2;
    --accent: #2d5a8e;
    --accent2: #8e2d2d;
    --shadow: rgba(26,26,46,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--ink);
    color: var(--paper);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse 80% 50% at 20% 20%, rgba(201,168,76,0.08) 0%, transparent 60%),
      radial-gradient(ellipse 60% 80% at 80% 80%, rgba(45,90,142,0.12) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .grain {
    position: fixed;
    inset: 0;
    opacity: 0.03;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  /* Header */
  header {
    position: relative;
    z-index: 10;
    text-align: center;
    padding: 60px 20px 40px;
    border-bottom: 1px solid rgba(201,168,76,0.2);
  }

  .logo-tag {
    display: inline-block;
    font-size: 11px;
    letter-spacing: 4px;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 16px;
    opacity: 0.8;
  }

  header h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    font-weight: 900;
    line-height: 1.05;
    background: linear-gradient(135deg, var(--paper) 30%, var(--gold) 70%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  header p {
    margin-top: 16px;
    color: rgba(245,240,232,0.55);
    font-size: 1rem;
    font-weight: 300;
    letter-spacing: 0.3px;
  }

  /* Main Layout */
  .container {
    position: relative;
    z-index: 10;
    max-width: 1100px;
    margin: 0 auto;
    padding: 40px 20px 80px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    align-items: start;
  }

  @media (max-width: 780px) {
    .container { grid-template-columns: 1fr; }
  }

  /* Form Panel */
  .form-panel {
    background: rgba(245,240,232,0.04);
    border: 1px solid rgba(201,168,76,0.15);
    border-radius: 20px;
    padding: 36px;
    backdrop-filter: blur(10px);
  }

  .panel-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.3rem;
    color: var(--gold);
    margin-bottom: 28px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .panel-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: rgba(201,168,76,0.2);
  }

  .form-section {
    margin-bottom: 24px;
  }

  .section-label {
    font-size: 10px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--gold);
    opacity: 0.6;
    margin-bottom: 12px;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-bottom: 12px;
  }

  label {
    font-size: 12px;
    color: rgba(245,240,232,0.55);
    letter-spacing: 0.5px;
  }

  input, select, textarea {
    background: rgba(245,240,232,0.06);
    border: 1px solid rgba(201,168,76,0.15);
    border-radius: 10px;
    padding: 11px 14px;
    color: var(--paper);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    transition: all 0.2s;
    width: 100%;
  }

  input::placeholder, textarea::placeholder { color: rgba(245,240,232,0.25); }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: rgba(201,168,76,0.5);
    background: rgba(245,240,232,0.08);
  }

  select option { background: var(--ink); }

  textarea { resize: vertical; min-height: 80px; }

  /* Skills/Experience dynamic rows */
  .dynamic-list { display: flex; flex-direction: column; gap: 8px; }
  .dynamic-item {
    display: flex;
    gap: 8px;
    align-items: center;
  }
  .dynamic-item input { flex: 1; }
  .btn-remove {
    background: rgba(142,45,45,0.2);
    border: 1px solid rgba(142,45,45,0.3);
    color: #e8a0a0;
    border-radius: 8px;
    width: 32px;
    height: 32px;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s;
  }
  .btn-remove:hover { background: rgba(142,45,45,0.4); }

  .btn-add {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--gold);
    background: rgba(201,168,76,0.08);
    border: 1px dashed rgba(201,168,76,0.3);
    border-radius: 8px;
    padding: 7px 14px;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 6px;
    font-family: 'DM Sans', sans-serif;
  }
  .btn-add:hover { background: rgba(201,168,76,0.15); }

  /* Generate Button */
  .btn-generate {
    width: 100%;
    padding: 16px;
    margin-top: 24px;
    background: linear-gradient(135deg, var(--gold) 0%, #a07830 100%);
    color: var(--ink);
    border: none;
    border-radius: 12px;
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
  }

  .btn-generate:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(201,168,76,0.35);
  }

  .btn-generate:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }

  /* Loading */
  .loading-bar {
    position: absolute;
    bottom: 0; left: 0;
    height: 3px;
    background: rgba(255,255,255,0.5);
    width: 0%;
    transition: width 0.3s;
    animation: loading 2s infinite;
  }

  @keyframes loading {
    0% { left: 0; width: 0%; }
    50% { width: 60%; }
    100% { left: 100%; width: 0%; }
  }

  /* CV Preview Panel */
  .cv-panel {
    position: sticky;
    top: 20px;
  }

  .cv-wrapper {
    background: white;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 30px 80px rgba(0,0,0,0.4);
    transform-origin: top center;
    min-height: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .cv-placeholder {
    text-align: center;
    padding: 60px 30px;
    color: rgba(26,26,46,0.3);
  }

  .cv-placeholder svg { margin-bottom: 16px; opacity: 0.4; }
  .cv-placeholder p { font-size: 14px; color: rgba(26,26,46,0.4); }

  /* CV Content */
  #cv-content {
    width: 100%;
    font-family: 'DM Sans', sans-serif;
    color: #1a1a2e;
  }

  .cv-header-bar {
    background: linear-gradient(135deg, #1a1a2e 0%, #2d3561 100%);
    padding: 36px 36px 28px;
    color: white;
  }

  .cv-name {
    font-family: 'Playfair Display', serif;
    font-size: 28px;
    font-weight: 700;
    color: white;
    line-height: 1.1;
  }

  .cv-title {
    color: var(--gold-light);
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-top: 6px;
  }

  .cv-contact-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 20px;
  }

  .cv-contact-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: rgba(255,255,255,0.75);
  }

  .cv-body {
    padding: 28px 36px;
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 28px;
  }

  .cv-sidebar {}
  .cv-main {}

  .cv-section {
    margin-bottom: 24px;
  }

  .cv-section-title {
    font-size: 10px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--accent);
    font-weight: 600;
    margin-bottom: 12px;
    padding-bottom: 6px;
    border-bottom: 2px solid var(--accent);
  }

  .cv-section-title-gold {
    font-size: 10px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: #8a7040;
    font-weight: 600;
    margin-bottom: 12px;
    padding-bottom: 6px;
    border-bottom: 2px solid var(--gold);
  }

  .cv-summary {
    font-size: 13px;
    line-height: 1.7;
    color: #444;
  }

  .cv-exp-item {
    margin-bottom: 18px;
  }

  .cv-exp-role {
    font-weight: 600;
    font-size: 14px;
    color: #1a1a2e;
  }

  .cv-exp-company {
    font-size: 12px;
    color: var(--accent);
    font-weight: 500;
  }

  .cv-exp-period {
    font-size: 11px;
    color: #999;
    margin-bottom: 6px;
  }

  .cv-exp-desc {
    font-size: 12px;
    color: #555;
    line-height: 1.6;
  }

  .cv-skill-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  .cv-skill-tag {
    background: rgba(45,90,142,0.1);
    color: var(--accent);
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 500;
  }

  .cv-edu-item {
    margin-bottom: 14px;
  }

  .cv-edu-degree {
    font-weight: 600;
    font-size: 13px;
    color: #1a1a2e;
  }

  .cv-edu-school {
    font-size: 12px;
    color: #666;
  }

  .cv-edu-year {
    font-size: 11px;
    color: #999;
  }

  .cv-lang-item {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    margin-bottom: 8px;
    color: #444;
  }

  .cv-lang-level {
    color: var(--accent);
    font-weight: 500;
  }

  /* Action buttons */
  .cv-actions {
    display: flex;
    gap: 10px;
    margin-top: 16px;
  }

  .btn-action {
    flex: 1;
    padding: 12px;
    border-radius: 10px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
  }

  .btn-download {
    background: linear-gradient(135deg, var(--gold) 0%, #a07830 100%);
    color: var(--ink);
  }

  .btn-download:hover { transform: translateY(-1px); box-shadow: 0 8px 24px rgba(201,168,76,0.3); }

  .btn-copy {
    background: rgba(245,240,232,0.08);
    border: 1px solid rgba(201,168,76,0.2) !important;
    color: var(--paper);
  }

  .btn-copy:hover { background: rgba(245,240,232,0.12); }

  /* Status */
  .status-msg {
    text-align: center;
    font-size: 13px;
    color: var(--gold);
    margin-top: 12px;
    min-height: 20px;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .status-msg.visible { opacity: 1; }

  /* Progress indicator */
  .progress-steps {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 20px;
    margin-bottom: 8px;
  }

  .step-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: rgba(201,168,76,0.25);
    transition: all 0.3s;
  }

  .step-dot.active {
    background: var(--gold);
    transform: scale(1.5);
  }

  .step-dot.done { background: rgba(201,168,76,0.6); }

  @media print {
    body { background: white; }
    .form-panel, header, .cv-actions, .grain, .progress-steps, .status-msg { display: none; }
    .container { display: block; padding: 0; }
    .cv-panel { position: static; }
    .cv-wrapper { box-shadow: none; border-radius: 0; }
  }
</style>
</head>
<body>
<div class="grain"></div>

<header>
  <div class="logo-tag">‚ú¶ Powered by Claude AI</div>
  <h1>CV Generator</h1>
  <p>Masukkan data Anda ‚Äî AI akan menulis CV profesional secara otomatis</p>
</header>

<div class="container">
  <!-- FORM PANEL -->
  <div class="form-panel">
    <div class="panel-title">Data Diri</div>

    <div class="form-section">
      <div class="section-label">Informasi Pribadi</div>
      <div class="form-row">
        <div class="form-group">
          <label>Nama Lengkap *</label>
          <input type="text" id="nama" placeholder="Budi Santoso" />
        </div>
        <div class="form-group">
          <label>Tanggal Lahir *</label>
          <input type="date" id="tgl_lahir" />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Email *</label>
          <input type="email" id="email" placeholder="budi@email.com" />
        </div>
        <div class="form-group">
          <label>Nomor HP</label>
          <input type="tel" id="telepon" placeholder="+62 812..." />
        </div>
      </div>
      <div class="form-group">
        <label>Kota / Lokasi</label>
        <input type="text" id="lokasi" placeholder="Jakarta, Indonesia" />
      </div>
      <div class="form-group">
        <label>LinkedIn / Portfolio URL</label>
        <input type="text" id="linkedin" placeholder="linkedin.com/in/namakamu" />
      </div>
    </div>

    <div class="form-section">
      <div class="section-label">Karir & Tujuan</div>
      <div class="form-group">
        <label>Posisi / Jabatan yang Dituju *</label>
        <input type="text" id="posisi" placeholder="Software Engineer, Marketing Manager, dll." />
      </div>
      <div class="form-group">
        <label>Ringkasan Diri (opsional ‚Äî AI akan membuatkan)</label>
        <textarea id="ringkasan" placeholder="Ceritakan sedikit tentang diri Anda, minat, atau kekuatan Anda..."></textarea>
      </div>
    </div>

    <div class="form-section">
      <div class="section-label">Pengalaman Kerja</div>
      <div class="dynamic-list" id="exp-list">
        <div class="dynamic-item">
          <input type="text" placeholder="Contoh: 2020‚Äì2023 | Software Engineer | PT Maju Jaya" />
          <button class="btn-remove" onclick="removeItem(this)">√ó</button>
        </div>
      </div>
      <button class="btn-add" onclick="addItem('exp-list', 'Contoh: 2021‚Äì2024 | Data Analyst | Startup XYZ')">+ Tambah Pengalaman</button>
    </div>

    <div class="form-section">
      <div class="section-label">Pendidikan</div>
      <div class="dynamic-list" id="edu-list">
        <div class="dynamic-item">
          <input type="text" placeholder="Contoh: 2016‚Äì2020 | S1 Teknik Informatika | Universitas Indonesia" />
          <button class="btn-remove" onclick="removeItem(this)">√ó</button>
        </div>
      </div>
      <button class="btn-add" onclick="addItem('edu-list', 'Contoh: 2012‚Äì2016 | SMA Negeri 1 Jakarta')">+ Tambah Pendidikan</button>
    </div>

    <div class="form-section">
      <div class="section-label">Keahlian (Skills)</div>
      <div class="dynamic-list" id="skill-list">
        <div class="dynamic-item">
          <input type="text" placeholder="Contoh: JavaScript, Python, React..." />
          <button class="btn-remove" onclick="removeItem(this)">√ó</button>
        </div>
      </div>
      <button class="btn-add" onclick="addItem('skill-list', 'Contoh: Project Management, Komunikasi...')">+ Tambah Skill</button>
    </div>

    <div class="form-section">
      <div class="section-label">Bahasa yang Dikuasai</div>
      <div class="dynamic-list" id="lang-list">
        <div class="dynamic-item">
          <input type="text" placeholder="Contoh: Bahasa Indonesia (Native), Inggris (Profesional)" />
          <button class="btn-remove" onclick="removeItem(this)">√ó</button>
        </div>
      </div>
      <button class="btn-add" onclick="addItem('lang-list', 'Contoh: Mandarin (Dasar)')">+ Tambah Bahasa</button>
    </div>

    <div class="form-section">
      <div class="section-label">Sertifikasi / Penghargaan (opsional)</div>
      <div class="dynamic-list" id="cert-list">
        <div class="dynamic-item">
          <input type="text" placeholder="Contoh: AWS Certified Developer ‚Äì 2022" />
          <button class="btn-remove" onclick="removeItem(this)">√ó</button>
        </div>
      </div>
      <button class="btn-add" onclick="addItem('cert-list', 'Contoh: Google Analytics Certified')">+ Tambah Sertifikasi</button>
    </div>

    <button class="btn-generate" id="gen-btn" onclick="generateCV()">
      <span id="gen-label">‚ú¶ Generate CV dengan AI</span>
      <div class="loading-bar" id="loading-bar" style="display:none"></div>
    </button>

    <div class="status-msg" id="status-msg"></div>
  </div>

  <!-- CV PREVIEW PANEL -->
  <div class="cv-panel">
    <div class="panel-title">Preview CV</div>

    <div class="cv-wrapper" id="cv-wrapper">
      <div class="cv-placeholder">
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
          <rect x="8" y="4" width="32" height="40" rx="4" stroke="#1a1a2e" stroke-width="2"/>
          <line x1="14" y1="16" x2="34" y2="16" stroke="#1a1a2e" stroke-width="2"/>
          <line x1="14" y1="22" x2="34" y2="22" stroke="#1a1a2e" stroke-width="2"/>
          <line x1="14" y1="28" x2="26" y2="28" stroke="#1a1a2e" stroke-width="2"/>
        </svg>
        <p>CV Anda akan muncul di sini<br>setelah mengisi data dan klik Generate</p>
      </div>
    </div>

    <div class="cv-actions" id="cv-actions" style="display:none">
      <button class="btn-action btn-download" onclick="downloadCV()">‚¨á Download HTML</button>
      <button class="btn-action btn-copy" onclick="printCV()">üñ® Print / PDF</button>
    </div>
  </div>
</div>

<script>
function addItem(listId, placeholder) {
  const list = document.getElementById(listId);
  const div = document.createElement('div');
  div.className = 'dynamic-item';
  div.innerHTML = `<input type="text" placeholder="${placeholder}" /><button class="btn-remove" onclick="removeItem(this)">√ó</button>`;
  list.appendChild(div);
  div.querySelector('input').focus();
}

function removeItem(btn) {
  const list = btn.closest('.dynamic-list');
  if (list.children.length > 1) btn.closest('.dynamic-item').remove();
}

function getListValues(listId) {
  return Array.from(document.querySelectorAll(`#${listId} input`))
    .map(i => i.value.trim()).filter(Boolean);
}

function setStatus(msg, visible = true) {
  const el = document.getElementById('status-msg');
  el.textContent = msg;
  el.classList.toggle('visible', visible);
}

async function generateCV() {
  const nama = document.getElementById('nama').value.trim();
  const tgl = document.getElementById('tgl_lahir').value;
  const email = document.getElementById('email').value.trim();
  const posisi = document.getElementById('posisi').value.trim();

  if (!nama || !email || !posisi) {
    setStatus('‚ö† Mohon isi Nama, Email, dan Posisi yang Dituju.');
    return;
  }

  const btn = document.getElementById('gen-btn');
  const label = document.getElementById('gen-label');
  btn.disabled = true;
  label.textContent = '‚è≥ AI sedang menulis CV Anda...';
  setStatus('ü§ñ Menghubungi AI dan menyusun kata-kata profesional...');

  // Collect data
  const data = {
    nama,
    tgl_lahir: tgl,
    email,
    telepon: document.getElementById('telepon').value.trim(),
    lokasi: document.getElementById('lokasi').value.trim(),
    linkedin: document.getElementById('linkedin').value.trim(),
    posisi,
    ringkasan_user: document.getElementById('ringkasan').value.trim(),
    pengalaman: getListValues('exp-list'),
    pendidikan: getListValues('edu-list'),
    skills: getListValues('skill-list'),
    bahasa: getListValues('lang-list'),
    sertifikasi: getListValues('cert-list'),
  };

  // Build prompt
  const prompt = `Anda adalah penulis CV profesional Indonesia yang berpengalaman. Buat CV lengkap dalam format JSON berdasarkan data berikut:

NAMA: ${data.nama}
TANGGAL LAHIR: ${data.tgl_lahir || 'tidak disebutkan'}
EMAIL: ${data.email}
TELEPON: ${data.telepon || 'tidak disebutkan'}
LOKASI: ${data.lokasi || 'tidak disebutkan'}
LINKEDIN/PORTFOLIO: ${data.linkedin || 'tidak disebutkan'}
POSISI YANG DITUJU: ${data.posisi}
RINGKASAN DARI USER: ${data.ringkasan_user || 'tidak ada, buatkan sendiri'}
PENGALAMAN KERJA: ${data.pengalaman.join(' | ') || 'tidak disebutkan'}
PENDIDIKAN: ${data.pendidikan.join(' | ') || 'tidak disebutkan'}
SKILLS: ${data.skills.join(', ') || 'tidak disebutkan'}
BAHASA: ${data.bahasa.join(', ') || 'tidak disebutkan'}
SERTIFIKASI: ${data.sertifikasi.join(', ') || 'tidak ada'}

Tugas:
1. Buat ringkasan profesional (3-4 kalimat) yang kuat, spesifik untuk posisi "${data.posisi}", tone percaya diri & profesional
2. Untuk setiap pengalaman kerja: parse dan buat deskripsi 2-3 bullet point yang menunjukkan dampak nyata
3. Lengkapi data yang kurang dengan asumsi realistis dan profesional
4. Gunakan bahasa Indonesia yang formal dan impresif

Kembalikan HANYA JSON valid (tanpa backticks, tanpa penjelasan) dengan format:
{
  "nama": "string",
  "posisi_target": "string",
  "email": "string",
  "telepon": "string",
  "lokasi": "string",
  "linkedin": "string",
  "usia": "string (hitung dari tgl lahir jika ada, atau 'tidak disebutkan')",
  "ringkasan": "string (paragraf 3-4 kalimat profesional)",
  "pengalaman": [
    {
      "jabatan": "string",
      "perusahaan": "string",
      "periode": "string",
      "deskripsi": ["bullet 1", "bullet 2", "bullet 3"]
    }
  ],
  "pendidikan": [
    {
      "gelar": "string",
      "institusi": "string",
      "tahun": "string"
    }
  ],
  "skills": ["skill1", "skill2", ...],
  "bahasa": [{"nama": "string", "level": "string"}],
  "sertifikasi": ["string", ...]
}`;

  try {
    const res = await fetch('/.netlify/functions/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt })
    });

    const apiData = await res.json();
    let text = apiData.content?.map(c => c.text || '').join('') || '';

    // Strip markdown
    text = text.replace(/```json|```/g, '').trim();

    const cv = JSON.parse(text);
    renderCV(cv);
    setStatus('‚úÖ CV berhasil dibuat!');
    document.getElementById('cv-actions').style.display = 'flex';
  } catch (e) {
    console.error(e);
    setStatus('‚ùå Gagal menghubungi AI. Pastikan koneksi internet aktif.');
  } finally {
    btn.disabled = false;
    label.textContent = '‚ú¶ Generate Ulang CV';
  }
}

function renderCV(cv) {
  const wrapper = document.getElementById('cv-wrapper');

  const expHTML = (cv.pengalaman || []).map(e => `
    <div class="cv-exp-item">
      <div class="cv-exp-role">${e.jabatan || ''}</div>
      <div class="cv-exp-company">${e.perusahaan || ''}</div>
      <div class="cv-exp-period">${e.periode || ''}</div>
      <div class="cv-exp-desc">
        ${(e.deskripsi || []).map(d => `‚Ä¢ ${d}`).join('<br>')}
      </div>
    </div>
  `).join('');

  const eduHTML = (cv.pendidikan || []).map(e => `
    <div class="cv-edu-item">
      <div class="cv-edu-degree">${e.gelar || ''}</div>
      <div class="cv-edu-school">${e.institusi || ''}</div>
      <div class="cv-edu-year">${e.tahun || ''}</div>
    </div>
  `).join('');

  const skillHTML = (cv.skills || []).map(s => `<span class="cv-skill-tag">${s}</span>`).join('');

  const langHTML = (cv.bahasa || []).map(l => `
    <div class="cv-lang-item">
      <span>${l.nama}</span>
      <span class="cv-lang-level">${l.level}</span>
    </div>
  `).join('');

  const certHTML = cv.sertifikasi?.length ? `
    <div class="cv-section">
      <div class="cv-section-title-gold">Sertifikasi</div>
      ${cv.sertifikasi.map(c => `<div style="font-size:12px;color:#555;margin-bottom:6px;">üèÖ ${c}</div>`).join('')}
    </div>
  ` : '';

  wrapper.innerHTML = `
    <div id="cv-content">
      <div class="cv-header-bar">
        <div class="cv-name">${cv.nama || ''}</div>
        <div class="cv-title">${cv.posisi_target || ''}</div>
        <div class="cv-contact-bar">
          ${cv.email ? `<div class="cv-contact-item">‚úâ ${cv.email}</div>` : ''}
          ${cv.telepon ? `<div class="cv-contact-item">üìû ${cv.telepon}</div>` : ''}
          ${cv.lokasi ? `<div class="cv-contact-item">üìç ${cv.lokasi}</div>` : ''}
          ${cv.linkedin ? `<div class="cv-contact-item">üîó ${cv.linkedin}</div>` : ''}
          ${cv.usia && cv.usia !== 'tidak disebutkan' ? `<div class="cv-contact-item">üéÇ ${cv.usia}</div>` : ''}
        </div>
      </div>
      <div class="cv-body">
        <div class="cv-sidebar">
          ${skillHTML ? `<div class="cv-section">
            <div class="cv-section-title-gold">Keahlian</div>
            <div class="cv-skill-list">${skillHTML}</div>
          </div>` : ''}
          ${eduHTML ? `<div class="cv-section">
            <div class="cv-section-title-gold">Pendidikan</div>
            ${eduHTML}
          </div>` : ''}
          ${langHTML ? `<div class="cv-section">
            <div class="cv-section-title-gold">Bahasa</div>
            ${langHTML}
          </div>` : ''}
          ${certHTML}
        </div>
        <div class="cv-main">
          ${cv.ringkasan ? `<div class="cv-section">
            <div class="cv-section-title">Profil Profesional</div>
            <div class="cv-summary">${cv.ringkasan}</div>
          </div>` : ''}
          ${expHTML ? `<div class="cv-section">
            <div class="cv-section-title">Pengalaman Kerja</div>
            ${expHTML}
          </div>` : ''}
        </div>
      </div>
    </div>
  `;
}

function downloadCV() {
  const content = document.getElementById('cv-content');
  if (!content) return;
  const html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>CV</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
body{font-family:'DM Sans',sans-serif;margin:0;color:#1a1a2e}
:root{--accent:#2d5a8e;--gold:#c9a84c;--gold-light:#e8d5a3}
${document.querySelector('style').textContent}
</style></head><body>${content.outerHTML}</body></html>`;
  const a = document.createElement('a');
  a.href = 'data:text/html;charset=utf-8,' + encodeURIComponent(html);
  a.download = 'CV_' + (document.getElementById('nama').value || 'saya') + '.html';
  a.click();
}

function printCV() {
  window.print();
}
</script>
</body>
</html>
